require(['jquery', 'ByteArray', 'BPTree', 'BiomTable', 'SummaryHelper'], function($, ByteArray, BPTree, BiomTable, SummaryHelper) {
    $(document).ready(function() {
        // Setup test variables
        // Note: This is ran for each test() so tests can modify bpArray without
        // effecting other test
        module('SummaryHelper' , {
            setup: function() {
                this.bpArray = new Uint8Array([1, 1, 1, 0, 1, 0, 1, 1 ,0, 0, 0,
                        1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0]);

                //this.names = ["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21"];

                this.names = [...Array(10).keys()];
                this.lengths = this.names.map(k => parseInt(k));
                this.bpObj = new BPTree(this.bpArray, this.names, this.lengths);

                this.obs = {"1": [2, 3],"2":[3,4,5],"3":[8,4,6]};
                this.samp = {
                  "1": {"cat1": 0},
                  "2": {"cat2": 0},
                  "3": {"cat3": 0}
                };
                this.biomTable = new BiomTable(this.obs, this.samp);

                // rank caches
                this.r0 = ByteArray.sumVal(this.bpArray, Uint32Array, 0);
                this.r1 = ByteArray.sumVal(this.bpArray, Uint32Array, 1);

                // select caches
                this.s0 = ByteArray.seqUniqueIndx(this.r0, Uint32Array);
                this.s1 = ByteArray.seqUniqueIndx(this.r1, Uint32Array);
            },

            teardown: function() {
                this.bpArray = null;
            }
        });

        // tests unifrac small
        /*test('Test unifrac', function() {
            var sIds1 = ["1", "3"]
            var sIds2 = ["1", "2"]
            equal(SummaryHelper.unifrac(this.biomTable, this.bpObj, sIds1, sIds2), 19/28);
        });*/

        // test unifrac large
        test('Test unifrac pairwise', function() {

          var bpArray =  new Uint8Array([1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]);

          var names = [null, null, null, '169901', null, '100344', null, null, '1684221', null, null, '1136443', '4374042', null, 'p__Firmicutes', null, null, '263705', '376397', '263452', null, 'c__Clostridia; o__Clostridiales', null, null, '229459', '1571092', '827195', null, null, null, '162991', '318370', null, '267689', '335952', '276044', null, null, null, '186521', null, null, null, '195840', '181603', null, '269378', null, null, null, '215193', '199307', '344527', '187790', null, '267041', '441494', null, null, '274438', null, null, '268121', null, '194787', null, '337331', '267411', '181205', null, '4418586', null, null, null, 'c__Clostridia; o__Clostridiales', null, null, null, '4471135', '195445', null, '172705', '2575787', null, '269576', null, null, null, '259593', '1105328', '208571', null, '182621', '271449', '181419', null, 'c__Clostridia; o__Clostridiales; f__Lachnospiraceae', null, null, null, null, null, '191958', null, null, '316842', '194822', '175432', '343906', '3392842', null, '351881', '346098', null, null, null, null, null, '191077', '351794', null, null, null, '4364243', '261419', '231169', null, '403497', null, '261334', '340189', null, '293580', '3265889', '292745', null, '322062', '190273', null, '288931', null, null, '553395', '302407', null, '833390', null, '275707', '450047', null, null, '132114', null, 'c__Clostridia; o__Clostridiales', '274422', null, '314810', '422727', null, null, 'c__Clostridia; o__Clostridiales', null, null, 'f__Ruminococcaceae; g__Ruminococcus', null, null, null, '190242', null, '265940', '170950', '187133', '4417539', null, '267452', '231021', null, null, '550807', null, 'g__Oscillospira', null, null, null, null, null, null, '4484382', null, null, null, '276404', null, '258725', '4403349', '321484', '263546', '196194', '269019', '270385', null, null, '182033', '263165', null, '260753', '191816', '270519', null, null, null, null, '262677', '272953', null, '187807', '276985', '263106', '176118', null, '170555', '263044', 'f__Clostridiaceae', '301870', null, '259212', '185222', null, null, '732128', '166099', '4480176', null, null, '179188', '194662', '261511', null, '273084', 'c__Erysipelotrichi', null, null, null, null, '260663', null, '265786', '260397', '275627', '4396877', '828435', null, null, '45363', '259266', '4407703', '262409', null, null, '262766', null, '180206', null, null, null, '262869', '260655', null, null, null, '349142', '195385', null, null, '176858', '263362', '233313', null, null, null, '178031', null, '259263', '263946', '268416', null, '97294', '258969', null, null, null, '187703', '259056', '191772', '276260', null, null, null, '184151', '176039', '310490', null, null, '333053', null, null, null, null, null, null, null, null, '331965', '261409', '185777', null, '259434', '276531', '303479', '263908', null, null, '258522', '274021', '181344', null, '272454', '176850', '275563', '318563', null, null, null, null, null, null, '312476', '174272', null, null, null, '268755', '268581', null, '179719', '264021', null, '260058', null, '167204', '829401', null, null, null, null, null, null, null, null, '178926', '196825',null, '443945', '310748', '260756', null, null, null, null, '233817', '259910', '197775', '130335', '4365109', null, null, '334365', '271766', null, '206494', '181249', null, null, null, null, null, '265828', '216403', '180919', null, null, '270662', '229386', null, '187989', '164308', null, null, '307595', '178779', '259888', '173417', null, '186526', '233411', null, '301012', null, '266483', '839215', null, null, null, null, null, null, null, '175416', null, null, null, '181141', '197216', null, '273515', '188536', '697874', null, '179181', null, '268923', '351859', null, null, null, null, '185743', '274844', null, '190460', '192971', '270396', '336145', null, null, null, '274597', null, null, '259228', '264373', null, null, null, '343581', '266595', '269359', '275150', null, '197790', null, null, '274106', '260828', null, null, '180105', null, '196777', '179063', '177802', null, null, null, null, null, null, '275078', '271378', '276580', '260653', null, '259335', '269992', null, '261606', null, null, '260205', '837473', '259175', null, '272812', null, '275136', '265641', null, '180362', '214471', null, null, '276663', null, '1108453', '267457', null, '174959', '185754', null, '181091', null, '319909', '4462541', null, null, null, null, null, '291750', '178659', '350381', null, null, null, null, null, '314963', null, '234121', '274018', null, null, '330296', '343420', '267388', null, null, '175573', null, null, null, '274521', '191887', '2120775', '436341', null, '199181', '266816', null, null, '180972', '183211', '227886', null, '348398', '270491', null, '327236', '182016', null, '258250', null, '275819', '275470', null, null, '320490', '311174', null, '193463', '191398', null, null, '354957', '183390', '275869', null, '461524', null, null, '265106', null, '178735', '267123', '199403', null, null, '115186', '687185', null, '214919', null, null, null, null, null, '4397402', '187233', '166911', '4338733', null, null, null, '452823', '259372', '239571', '135956', '303652', null, null, null, null, null, null, null, '1107945', null, null, '2137001', '4468234', '191483', '353782', null, null, null, '4346374', '184567', '4414420', null, '4372578', '3621189', null, '4449524', '173807', null, null, null, null, null, null, null, '3206355', null, '260387', '269902', '179069', '182995', '174663', '196138', null, '262399', '262166', null, null, null, null, null, '194978', '187078', '177205', '259249', null, '187644', '163862', null, null, null, null, null, null, null, '197318', '186497', '167078', null, '176886', null, '174754', '174791', '264496', null, '259609', '380534', null, null, null, '275339', '264787', null, '210950', null, '204144', '195005', null, null, '261177', null, '174056', '199698', '259012', null, null, '183106', '177427', null, '270984', '259859', null, null, null, null, null, '199534', '4127460', null, '169398', '336214', '276172', '270391', '4331760', null, 'f__[Odoribacteraceae]', null, '2112006', '170335', '3117556', null, '847228', null, '4329571', '4442459'];

          var lengths = [null, 0, 0.19527, 0.39755, 0.08322, 0.37296, 0.02085, 0.01143, 0.33084, 0.02284, 0.2205, 0.00014, 0.00204, 0.04842, 0.00964, 0.09446, 0.02493, 0.02657, 0.05743, 0.09328, 0.06256, 0.01046, 0.16617, 0.03291, 0.04726, 0.0371, 0.03981, 0.02402, 0.08285, 0.00873, 0.01263, 0.02928, 0.00962, 0.0087, 0.01692, 0.25511, 0.03382, 0.01217, 0.01105, 0.09255, 0.00686, 0.01861, 0.0487, 0.05097, 0.04737, 0.06458, 0.05555, 0.05223, 0.01912, 0.03584, 0.01971, 0.02787, 0.06642, 0.06549, 0.00852, 0.06668, 0.29606, 0.01695, 0.00953, 0.08266, 0.00228, 0.00293, 0.04956, 0.01187, 0.05527, 0.00656, 0.0305, 0.12086, 0.07086, 0.00127, 0.09245, 0.03292, 0.00744, 0.00336, 0.00169, 0.00147, 0.00173, 0.00973, 0.04783, 0.06353, 0.01157, 0.09236, 0.21784, 0.01507, 0.04917, 0.01471, 0.0008, 0.00102, 0.02332, 0.012, 0.01117, 0.00713, 0.08672, 0.02772, 0.03032, 0.0016, 0.00448, 0.00451, 0.048, 0.00315, 0.00921, 0.00247, 0.01976, 0.01834, 0.00721, 0.02735, 0.01128, 0.01301, 0.02151, 0.00869, 0.00695, 0.04144, 0.02522, 0.00564, 0.00014, 0.00543, 0.00429, 0.00467, 0.05103, 0.07438, 0.00753, 0.0132, 0.01097, 0.04249, 0.04021, 0.01264, 0.00256, 0.04479, 0.01024, 0.01174, 0.05963, 0.00656, 0.02795, 0.05414, 0.04202, 0.04098, 0.01797, 0.01058, 0.01294, 0.03379, 0.0115, 0.01312, 0.05483, 0.0199, 0.0492, 0.00627, 0.01342, 0.02319, 0.00348, 0.0007, 0.00805, 0.18434, 0.01056, 0.00016, 0.21213, 0.08472, 0.04013, 0.06862, 0.00839, 0.01284, 0.00284, 0.0112, 0.00843, 0.01162, 0.01312, 0.03409, 0.05634, 0.01884, 0.03275, 0.00636, 0.02803, 0.06732, 0.16601, 0.22655, 0.01884, 0.02579, 0.01303, 0.02515, 0.14219, 0.02295, 0.02244, 0.022, 0.00674, 0.02724, 0.00207, 0.01292, 0.00344, 0.03105, 0.04859, 0.00374, 0.02161, 0.01013, 0.01233, 0.01776, 0.01479, 0.05463, 0.05758, 0.03084, 0.02212, 0.07485, 0.05687, 0.0503, 0.00895, 0.00701, 0.0122, 0.01819, 0.05696, 0.05105, 0.04356, 0.06462, 0.0029, 0.01976, 0.00993, 0.00844, 0.00809, 0.0179, 0.03212, 0.01522, 0.04609, 0.19443, 0.01542, 0.02129, 0.02365, 0.15284, 0.03418, 0.12329, 0.23345, 0.21389, 0.00226, 0.0582, 0.08664, 0.02225, 0.01032, 0.00318, 0.04915, 0.09909, 0.06272, 0.00127, 0.05892, 0.11955, 0.08237, 0.01023, 0.14991, 0.00014, 0.02738, 0.00102, 0.02702, 0.00524, 0.06381, 0.05675, 0.05156, 0.13663, 0.01623, 0.01629, 0.05658, 0.06932, 0.18866, 0.0081, 0.00603, 0.04848, 0.00758, 0.05998, 0.02587, 0.01331, 0.00395, 0.07152, 0.03801, 0.00851, 0.00147, 0.00159, 0.02154, 0.00634, 0.00408, 0.0004, 0.01629, 0.01476, 0.00963, 0.0039, 0.00532, 0.00147, 0.01612, 0.07026, 0.0181, 0.02447, 0.00842, 0.00502, 0.02181, 0.03813, 0.0168, 0.01041, 0.01444, 0.03164, 0.01433, 0.02529, 0.03673, 0.00257, 0.00551, 0.05897, 0.03171, 0.02716, 0.04338, 0.01131, 0.00923, 0.04164, 0.00741, 0.01607, 0.00176, 0.01457, 0.00508, 0.00853, 0.04786, 0.01822, 0.08704, 0.01737, 0.01487, 0.01824, 0.02291, 0.02123, 0.02542, 0.04835, 0.00566, 0.00554, 0.02949, 0.05646, 0.04727, 0.01689, 0.03068, 0.06171, 0.01872, 0.06893, 0.00971, 0.00187, 0.00421, 0.00433, 0.01245, 0.00785, 0.02917, 0.04651, 0.00992, 0.00394, 0.00878, 0.01177, 0.02385, 0.00417, 0.04377, 0.05912, 0.00244, 0.03496, 0.03983, 0.01011, 0.01565, 0.01471, 0.00533, 0.00441, 0.00474, 0.00157, 0.00669, 0.01777, 0.00883, 0.02199, 0.01879, 0.03013, 0.02387, 0.00905, 0.01673, 0.00354, 0.00866, 0.00786, 0.0001, 0.00475, 0.01695, 0.02372, 0.03254, 0.0344, 0.00257, 0.00976, 0.03359, 0.03304, 0.01657, 0.02039, 0.04899, 0.0056, 0.01198, 0.00272, 0.00659, 0.00681, 0.01611, 0.03131, 0.07082, 0.01998, 0.04132, 0.04106, 0.01722, 0.01745, 0.01675, 0.02502, 0.0098, 0.01155, 0.04286, 0.01324, 0.06879, 0.03133, 0.06098, 0.01221, 0.0164, 0.00659, 0.03892, 0.02063, 0.02079, 0.0076, 0.0035, 0.00361, 0.00489, 0.01462, 0.00759, 0.00429, 0.00368, 0.06589, 0.0203, 0.009, 0.00062, 0.02134, 0.04356, 0.0068, 0.06915, 0.03918, 0.0303, 0.00565, 0.08572, 0.03893, 0.11712, 0.05093, 0.00809, 0.00157, 0.00889, 0.02997, 0.07302, 0.06304, 0.0557, 0.01175, 0.02492, 0.13586, 0.06697, 0.01207, 0.01445, 0.00596, 0.05276, 0.01243, 0.00411, 0.09494, 0.04067, 0.01442, 0.00928, 0.00128, 0.00883, 0.03526, 0.02279, 0.04595, 0.0135, 0.07695, 0.00679, 0.00728, 0.03127, 0.02915, 0.01597, 0.00667, 0.00572, 0.02629, 0.02608, 0.02119, 0.01713, 0.01447, 0.01365, 0.00607, 0.00577, 0.00745, 0.00987, 0.05198, 0.04527, 0.06941, 0.01951, 0.02089, 0.00857, 0.01649, 0.03771, 0.01776, 0.01057, 0.01931, 0.01675, 0.0327, 0.0661, 0.05327, 0.01332, 0.01641, 0.0504, 0.04142, 0.02282, 0.0488, 0.03306, 0.00679, 0.00558, 0.07249, 0.01011, 0.12347, 0.04345, 0.08833, 0.05484, 0.01372, 0.0137, 0.05605, 0.05346, 0.01099, 0.01663, 0.00479, 0.00015, 0.00697, 0.01138, 0.00913, 0.01414, 0.02705, 0.03212, 0.016, 0.04236, 0.00294, 0.00348, 0.00336, 0.02373, 0.01383, 0.00158, 0.01522, 0.00813, 0.00199, 0.00877, 0.00828, 0.05277, 0.0044, 0.04471, 0.00729, 0.02026, 0.0148, 0.00412, 0.02619, 0.02143, 0.03204, 0.01208, 0.01288, 0.05741, 0.03119, 0.00806, 0.01057, 0.00911, 0.01607, 0.01216, 0.02149, 0.00318, 0.02772, 0.02379, 0.072, 0.06278, 0.01639, 0.03667, 0.0143, 0.02306, 0.00947, 0.05332, 0.00144, 0.04718, 0.01972, 0.03482, 0.0092, 0.04605, 0.0236, 0.00734, 0.05068, 0.04344, 0.07717, 0.23533, 0.11627, 0.05723, 0.01912, 0.03592, 0.02808, 0.03407, 0.02167, 0.02374, 0.05025, 0.18622, 0.01033, 0.04697, 0.0439, 0.07235, 0.07926, 0.05536, 0.05395, 0.01203, 0.00016, 0.02449, 0.04148, 0.01405, 0.18171, 0.04831, 0.00333, 0.00255, 0.00238, 0.01508, 0.02438, 0.03044, 0.15985, 0.39352, 0.02804, 0.05356, 0.08539, 0.11232, 0.08438, 0.08626, 0.00015, 0.03914, 0.00026, 0.03611, 0.02727, 0.02217, 0.02512, 0.0072, 0.01346, 0.01612, 0.02476, 0.04246, 0.02265, 0.04814, 0.00847, 0.03839, 0.01949, 0.14634, 0.22514, 0.0886, 0.0058, 0.02537, 0.00966, 0.00805, 0.01129, 0.01394, 0.05575, 0.02831, 0.01306, 0.00981, 0.04071, 0.11183, 0.06637, 0.06604, 0.09631, 0.01744, 0.00828, 0.00502, 0.01184, 0.01125, 0.01066, 0.00763, 0.0156, 0.01205, 0.03615, 0.01811, 0.02417, 0.03502, 0.01646, 0.00583, 0.00568, 0.0004, 0.00496, 0.00569, 0.00273, 0.03022, 0.0139, 0.02106, 0.05416, 0.01009, 0.02207, 0.0392, 0.014, 0.0416, 0.0376, 0.01009, 0.02492, 0.02199, 0.00235, 0.02039, 0.01257, 0.01699, 0.00088, 0.01172, 0.01363, 0.02314, 0.006, 0.0172, 0.02085, 0.00627, 0.03474, 0.01406, 0.03568, 0.08361, 0.05891, 0.00961, 0.01459, 0.04258, 0.02913, 0.02522, 0.02958, 0.03521, 0.11283, 0.02348, 0.00497, 0.00367, 0.0077, 0.02102, 0.03563, 0.02565, 0.01634, 0.01107, 0.01705, 0.0711, 0.04459, 0.02217, 0.0905, 0.03176, 0.09488, 0.05985, 0.13918, 0.14176, 0.03654, 0.03366, 0.02548, 0.01181];

          var bpObj = new BPTree(bpArray, names, lengths);

          var sIds = ['10084.PC.481', '10084.PC.593', '10084.PC.356', '10084.PC.355',
          '10084.PC.354', '10084.PC.636', '10084.PC.635', '10084.PC.607',
          '10084.PC.634'];

          var obs = {'10084.PC.481': ['197790', '206494', '181344', '214919', '265786', '172705', '169398', '273084', '3265889', '4365109', '233411', '452823', '177802', '176039', '177427', '178779', '1107945', '163862', '307595', '275150', '346098', '333053', '259056', '233313', '178031', '173417', '182621', '259372', '175416', '350381', '318370', '214471', '4417539', '170555', '180919', '176850', '4364243', '233817', '259434', '260205', '336145', '179063', '179719', '185743', '215193', '4468234', '97294', '259263', '227886', '272454', '195385', '267041', '267123', '349142', '260397', '274106', '275136', '4338733', '314810', '195005', '269902', '259228', '4397402', '264496', '194662', '261419', '269576', '199534', '276172', '263946', '293580', '270385', '173807', '175432'], '10084.PC.593': ['197790', '180206', '265786', '274422', '270662', '186497', '264787', '343420', '266483', '348398', '270396', '191077', '271378', '182016', '269992', '176886', '316842', '259372', '4372578', '314963', '100344', '177205', '839215', '191958', '179069', '194978', '259212', '259266', '192971', '239571', '260397', '274844', '3621189', '195005', '276985', '380534', '320490', '174056', '180972', '259910', '135956', '234121', '267457', '267452', '259593', '181419', '187078', '183211', '173807', '260387'], '10084.PC.356': ['276580', '206494', '195840', '181249', '185777', '331965', '169398', '4365109', '186497', '337331', '354957', '274018', '183106', '178926', '351859', '130335', '259888', '266483', '231021', '181205', '196194', '4480176', '436341', '231169', '259335', '187703', '191816', '275078', '233313', '336214', '262869', '262166', '177205', '839215', '216403', '199181', '260756', '194787', '3392842', '4484382', '184151', '227886', '260653', '229386', '204144', '334365', '314810', '187233', '343581', '291750', '301012', '174754', '4397402', '351881', '174056', '180972', '263546', '322062', '162991', '274021', '175573', '259859', '187807', '263362', '259175', '188536', '176118', '833390', '173807', '266816', '182995'], '10084.PC.355': ['206494', '4329571', '169398', '274018', '183106', '351859', '2575787', '266483', '260828', '4480176', '268416', '176039', '351794', '553395', '259335', '176886', '191887', '259056', '178659', '174272', '310748', '336214', '550807', '177205', '839215', '274521', '262766', '176858', '268121', '233817', '199698', '260756', '260753', '336145', '196138', '275869', '276260', '270984', '302407', '258969', '4468234', '227886', '174791', '732128', '192971', '180105', '195005', '269902', '174754', '4397402', '351881', '264496', '180972', '340189', '135956', '175573', '4471135', '181603', '833390', '182995', '310490', '2120775', '260387', '190460', '186526'], '10084.PC.354': ['206494', '268581', '330296', '195840', '4365109', '263044', '196825', '183106', '265828', '292745', '269378', '343420', '194822', '348398', '262677', '263452', '4480176', '187133', '270491', '190273', '436341', '268755', '450047', '195445', '178659', '550807', '376397', '177205', '839215', '4462541', '261409', '216403', '199181', '336145', '260058', '276260', '259212', '4468234', '181141', '227886', '166911', '443945', '318563', '334365', '403497', '267388', '274844', '4338733', '314810', '1105328', '275627', '269902', '303479', '4397402', '351881', '264496', '180972', '183390', '187989', '135956', '162991', '175573', '259859', '275707', '4407703', '173807', '186521'], '10084.PC.636': ['180206', '258250', '1136443', '4329571', '174663', '259609', '180362', '276663', '186497', '183106', '262399', '178926', '45363', '179181', '837473', '259249', '275339', '687185', '4374042', '1107945', '4331760', '275470', '270391', '269992', '164308', '327236', '177205', '264373', '187644', '276044', '4484382', '4468234', '204144', '199403', '182033', '195005', '276985', '174056', '115186', '267689', '276172', '197318', '167078', '182995', '263165', '260387'], '10084.PC.635': ['258250', '174663', '259609', '311174', '258522', '169398', '3265889', '271449', '264787', '3117556', '337331', '274018', '261606', '262399', '199307', '265641', '269378', '3206355', '263452', '344527', '275339', '4374042', '259335', '1107945', '269359', '270391', '176886', '828435', '259056', '178659', '336214', '550807', '190242', '174959', '214471', '274597', '177205', '272812', '166099', '233817', '229459', '199698', '260205', '275819', '266595', '4468234', '4403349', '182033', '269902', '1108453', '187790', '422727', '4449524', '267689', '162991', '4414420', '193463', '276172', '197318', '270519', '276404', '191398', '176118', '167078', '266816', '182995', '697874', '321484', '170335', '260387', '4418586'], '10084.PC.607': ['827195', '1136443', '276531', '265940', '265786', '259609', '258522', '169398', '264787', '185222', '179188', '196777', '210950', '197775', '263106', '181091', '4374042', '270391', '319909', '272953', '269992', '167204', '263705', '190242', '461524', '259012', '318370', '100344', '273515', '4462541', '271766', '336145', '261334', '170950', '260058', '266595', '312476', '275563', '270984', '262409', '261177', '260397', '288931', '267411', '269902', '274438', '263908', '380534', '335952', '258725', '194662', '191772', '174056', '303652', '260663', '267689', '1571092', '266816', '182995', '1684221', '260387', '197216'], '10084.PC.634': ['214919', '174663', '169398', '276663', '186497', '264021', '2112006', '3117556', '185222', '266483', '275339', '2137001', '191077', '4374042', '191483', '343906', '1107945', '270391', '353782', '176886', '132114', '178031', '847228', '265106', '4127460', '261511', '185754', '268121', '178735', '276044', '4396877', '829401', '4468234', '184567', '269019', '260655', '261177', '301870', '208571', '195005', '269902', '276985', '4414420', '276172', '441494', '4346374', '169901', '182995', '4442459', '268923', '170335']};


          var biomTable = new BiomTable(obs, this.samp);
        
          var exp = [
            [0., 0.71836067, 0.71317361, 0.69746044, 0.62587207, 0.72826674,
              0.72065895, 0.72640581, 0.73606053],
            [0.71836067, 0.        , 0.70302967, 0.73407301, 0.6548042,  0.71547381,
              0.78397813, 0.72318399, 0.76138933],
            [0.71317361, 0.70302967, 0.        , 0.61041275, 0.62331299, 0.71848305,
              0.70416337, 0.75258475, 0.79249029],
            [0.69746044, 0.73407301, 0.61041275, 0.        , 0.64392779, 0.70052733,
              0.69832716, 0.77818938, 0.72959894],
            [0.62587207, 0.6548042 , 0.62331299, 0.64392779, 0.       ,  0.75782689,
              0.71005144, 0.75065046, 0.78944369],
            [0.72826674, 0.71547381, 0.71848305, 0.70052733, 0.75782689, 0.,
              0.63593642, 0.71283615, 0.58314638],
            [0.72065895, 0.78397813, 0.70416337, 0.69832716, 0.71005144, 0.63593642,
              0.        , 0.69200762, 0.68972056],
            [0.72640581, 0.72318399, 0.75258475, 0.77818938, 0.75065046, 0.71283615,
              0.69200762, 0.        , 0.71514083],
            [0.73606053, 0.76138933, 0.79249029, 0.72959894, 0.78944369, 0.58314638,
              0.68972056, 0.71514083, 0.        ]
          ];
          equal(SummaryHelper.unifrac(biomTable, bpObj, Array(sIds[0]), Array(sIds[1])), exp[0][1]);
/*
            for (var i = 0; i < sIds.length; ++i){
              for (var j = 0; j < sIds.length; ++j){
                console.log(i);
                console.log(j);
                equal(SummaryHelper.unifrac(biomTable, bpObj, Array(sIds[i]), Array(sIds[j])), exp[i][j]);
              }
            }
*/

        });
    });
});
